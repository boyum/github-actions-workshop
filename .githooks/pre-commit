#!/bin/bash
# Pre-commit hook to ensure markdown files follow one-sentence-per-line format

echo "Checking markdown formatting..."

# Get list of staged markdown files
STAGED_MD_FILES=$(git diff --cached --name-only --diff-filter=ACM | grep '\.md$')

if [ -z "$STAGED_MD_FILES" ]; then
    echo "No markdown files to check."
    exit 0
fi

# Check if formatting script exists
if [ ! -f "scripts/format-markdown.py" ]; then
    echo "Warning: format-markdown.py not found. Skipping format check."
    exit 0
fi

echo "Formatting markdown files..."
python3 scripts/format-markdown.py

# Re-add any files that were formatted
for file in $STAGED_MD_FILES; do
    if [ -f "$file" ]; then
        git add "$file"
    fi
done

echo "âœ“ Markdown formatting complete"
exit 0
